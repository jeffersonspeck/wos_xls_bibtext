# Web of Science XLS to BibTeX Converter

## Description
This Python script processes multiple `.xls` files from **Web of Science** in the same directory and generates a single `.bib` file in the **BibTeX** format. Since **Web of Science exports references in XLS format**, this script helps merge multiple files while ensuring unique entries. The generated BibTeX file is enriched with metadata extracted from the XLS file, such as **article title, authors, journal, volume, issue, DOI, ISSN, keywords, and more**.

The script also ensures:
- **Duplicate entries are removed** by checking DOI or a combination of title and authors.
- **Only filled metadata fields are included** in the final BibTeX file.
- **Correct formatting of page numbers**, conference details, and book references.
- **Unique BibTeX citation keys**, preventing conflicts.

---

## Requirements
1. **Python 3.7 or higher**.
2. The following Python libraries:
   - `pandas`: For reading and processing XLS files.
   - `tqdm`: For displaying a progress bar.
   - `xlrd`: For reading `.xls` (Excel 97-2003 format).

Install these libraries with:
```bash
pip install pandas tqdm xlrd
```

---

## How to Use

### 1. Place XLS Files
Place all **`.xls`** files exported from **Web of Science** in the same directory as the script.

### 2. Run the Script
Execute the script using the command below. You will be prompted to provide the desired output **BibTeX file name**:
```bash
python wos_xls_to_bib.py
```

### 3. BibTeX Output
The script will generate a BibTeX file in the same directory with the name you specify.

### Example Console Output:
```bash
Processing the following XLS files:
 - savedrecs.xls
Processing entries: 100%|█████████████████████████████████| 865/865 [00:12<00:00, 70.32 entries/s]

Enter the output file name (without extension, press Enter for default): 
BibTeX file generated: WebOfScience_Results.bib
```

---

## What Happens During the Process
The script will:
  Read all `.xls` files in the directory.  
  Extract all relevant metadata.  
  Ensure each BibTeX key is unique.  
  Remove duplicate entries.  
  Format pages, journal issues, and conference details correctly.  
  Save everything into a single `.bib` file.  

---

## XLS Input Format
The **XLS** files should have the following column headers:

- **Article Title**: The title of the article.
- **Authors**: The list of authors.
- **Source Title**: The journal or conference name.
- **Volume**: The volume number.
- **Issue**: The issue number.
- **Start Page** / **End Page**: The range of pages.
- **DOI**: The DOI of the article.
- **ISSN** / **eISSN**: The ISSN of the journal.
- **ISBN**: The ISBN for books.
- **Abstract**: The abstract of the article.
- **Language**: The language of the article.
- **Author Keywords**: Keywords listed by the authors.
- **Conference Title**: If the article is from a conference.
- **Publication Year**: The year the article was published.
- **Institution**: The institution for theses or dissertations.
- **Pubmed Id**: If applicable.

---

## BibTeX Output Example
Here is an example of a **BibTeX** entry generated by the script:

```bibtex
@article{Smith_2023,
  title={Deep Learning for Medical Imaging Analysis},
  author={John Smith, Jane Doe},
  journal={Journal of Medical AI},
  year={2023},
  volume={45},
  number={2},
  pages={101-120},
  doi={10.1007/s12345-023-67890},
  issn={1234-5678},
  abstract={This study explores deep learning applications in medical imaging...},
  language={English},
  keywords={Deep Learning, Medical Imaging, AI in Healthcare},
}
```

For a **conference paper**:
```bibtex
@inproceedings{Johnson_2022,
  title={AI-based Models for Natural Language Processing},
  author={Michael Johnson, Alice Brown},
  conference={International Conference on AI and Data Science},
  year={2022},
  pages={50-65},
  doi={10.1109/ICAI2022.9876543},
}
```

For a **thesis**:
```bibtex
@phdthesis{Garcia_2021,
  title={Advancements in Quantum Computing},
  author={Carlos Garcia},
  institution={MIT},
  year={2021},
  degree={PhD in Computer Science},
}
```

---

## Key Fields in the Output
- **title** → Article or book title.  
- **author** → List of authors.  
- **journal** → Journal or conference name.  
- **year** → Publication year.  
- **volume** → Journal volume number.  
- **number** → Journal issue number.  
- **pages** → Start and end pages of the article.  
- **doi** → Digital Object Identifier.  
- **issn** / **eissn** → Journal ISSN.  
- **isbn** → ISBN for books.  
- **abstract** → Summary or abstract of the article.  
- **language** → Language of publication.  
- **keywords** → Author-provided keywords.  
- **publisher** → Institution (for theses/dissertations).  
- **conference** → Conference name (if applicable).  
- **address** → Institution address (if available).  

---

## Notes
- The script **automatically resolves duplicate BibTeX keys** by appending a letter (e.g., `Smith_2023a`, `Smith_2023b`).
- If any required metadata is **missing**, the script **skips that field** instead of inserting empty data.
- It is **optimized for Web of Science data exports**, but can be adapted for other sources if needed.

---
